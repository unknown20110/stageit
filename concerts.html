<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>×¡×˜×™×™×’'×™×˜ - ××¢×¨×›×ª × ×™×”×•×œ ×”×•×¤×¢×•×ª</title>
    <style>
 	      .chat-icon {
          position: absolute;
          top: 10px;
          right: 10px;
          background: white;
          border-radius: 50%;
          padding: 5px;
          font-size: 16px;
          box-shadow: 0 0 5px rgba(0,0,0,0.2);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            backdrop-filter: blur(10px);
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .stats-dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 50%, #fecfef 100%);
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            color: white;
            font-weight: bold;
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-card.pending { background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%); }
        .stat-card.contacted { background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%); }
        .stat-card.confirmed { background: linear-gradient(135deg, #d299c2 0%, #fef9d7 100%); }
        .stat-card.closed { background: linear-gradient(135deg, #89f7fe 0%, #66a6ff 100%); }

        .controls {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
            align-items: center;
        }

        .upload-section {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 30px;
            color: white;
        }

        .file-input {
            margin: 10px 0;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }

        .btn-primary {
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            color: white;
        }

        .btn-secondary {
            background: linear-gradient(45deg, #ffeaa7, #fab1a0);
            color: white;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .filter-input {
            padding: 10px 15px;
            border: 2px solid #ddd;
            border-radius: 25px;
            outline: none;
            transition: border-color 0.3s ease;
        }

        .filter-input:focus {
            border-color: #667eea;
        }

        .venues-grid {
            display: grid;
            gap: 20px;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
        }

        .venue-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            border-right: 5px solid #667eea;
            position: relative;
            overflow: hidden;
			display: flex;
            flex-direction: column; /* ×××¤×©×¨ ×œ×—×œ×§ ×”×¢×œ×™×•×Ÿ ×•×”×›×¤×ª×•×¨×™× ×œ×”×™×•×ª ××•×¤×¨×“×™× */
            justify-content: space-between; /* ×“×•×—×£ ××ª ×”×›×¤×ª×•×¨×™× ×œ×ª×—×ª×™×ª */
            height: 100%; /* ×—×©×•×‘! ×××¤×©×¨ ×œ×›×œ ×”×›×¨×˜×™×¡ ×œ×”×™×•×ª ×‘××•×ª×• ×’×•×‘×” */
        }

        .venue-card::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 100%;
            height: 3px;
            background: linear-gradient(90deg, #ff6b6b, #4ecdc4, #45b7d1);
        }

        .venue-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.15);
        }

        .venue-card.contacted {
            border-right-color: #f39c12;
            background: linear-gradient(135deg, rgba(243,156,18,0.05) 0%, transparent 100%);
        }

        .venue-card.confirmed {
            border-right-color: #27ae60;
            background: linear-gradient(135deg, rgba(39,174,96,0.05) 0%, transparent 100%);
        }

        .venue-card.closed {
            border-right-color: #e74c3c;
            background: linear-gradient(135deg, rgba(231,76,60,0.05) 0%, transparent 100%);
        }

        .venue-name {
            font-size: 1.4em;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .venue-info {
            display: grid;
            gap: 8px;
            margin-bottom: 15px;
        }

        .info-row {
            display: flex;
            align-items: center;
            gap: 10px;
            color: #555;
        }

        .icon {
            width: 16px;
            height: 16px;
            opacity: 0.7;
        }

        .actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        .status-select {
            padding: 8px 15px;
            border: 2px solid #ddd;
            border-radius: 20px;
            outline: none;
            background: white;
        }

        .message-preview {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            margin-top: 10px;
            font-size: 0.9em;
            border-right: 3px solid #667eea;
        }

        .ai-assistant {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px 20px;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .ai-assistant:hover {
            transform: scale(1.05);
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 2000;
            backdrop-filter: blur(5px);
        }

        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 30px;
            border-radius: 20px;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }

        .close {
            position: absolute;
            top: 15px;
            left: 15px;
            font-size: 24px;
            cursor: pointer;
            color: #999;
        }

        .hidden {
            display: none;
        }

        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            .venues-grid {
                grid-template-columns: 1fr;
            }
            
            .controls {
                flex-direction: column;
                align-items: stretch;
            }
        }
    </style>
</head>
<body>
    <div id="conversationModal" class="modal">
      <div class="modal-content">
        <span class="close" onclick="closeConversationModal()">&times;</span>
        <h2>ğŸ—£ï¸ ×¤×¨×˜×™× × ×•×¡×¤×™× ×•×ª×™×¢×•×“ ×©×™×—×”</h2>
		<div id="venueModalNotes" style="margin-bottom: 15px; font-size: 0.95em; background: #e8f0fe; padding: 10px; border-radius: 10px; border-right: 4px solid #4ecdc4;"></div>
        <div id="conversationHistory" style="max-height: 200px; overflow-y: auto; background: #f1f1f1; padding: 10px; border-radius: 10px; margin-bottom: 15px;"></div>
        <textarea id="conversationText" placeholder="×›×ª×•×‘ ×›××Ÿ ××ª ×¤×¨×˜×™ ×”×©×™×—×”..." style="width: 100%; height: 100px; padding: 10px; border-radius: 10px; border: 1px solid #ccc;"></textarea>
        <br><br>
        <button class="btn btn-primary" onclick="saveVenueConversation()">ğŸ’¾ ×©××•×¨ ×ª×™×¢×•×“</button>
      </div>
    </div>

    <div class="container">
        <h1 class="header">ğŸµ ×¡×˜×™×™×’'×™×˜ - ××¢×¨×›×ª × ×™×”×•×œ ×”×•×¤×¢×•×ª ğŸµ</h1>
        <h2 class="header">×œ×¡×’×•×¨ ×”×•×¤×¢×” ×–×” ×§×œ!</h2>
        <div class="upload-section">
            <h3>ğŸ“Š ×”×¢×œ××ª × ×ª×•× ×™×</h3>
<ul>
  <li>×”×•×¨×™×“×• ××ª <strong>×ª×‘× ×™×ª ×”-CSV</strong> ×¢×œ ×™×“×™ ×œ×—×™×¦×” ×¢×œ ×›×¤×ª×•×¨ <strong>â¬‡ï¸ ×”×•×¨×“×ª ×ª×‘× ×™×ª</strong>.</li>
  <li>×¤×ª×—×• ××ª ×”×§×•×‘×¥ ×‘-Excel ×•××œ××• ××ª <strong>×¤×¨×˜×™ ×”××§×•××•×ª</strong> ×‘×˜×•×¨×™× ×”××ª××™××™×.</li>
  <li>×œ××—×¨ ×¡×™×•× ×”×¢×¨×™×›×”, ×©××¨×• ××ª ×”×§×•×‘×¥ ×›×š:
    <ul>
      <li>×‘×—×¨×• <code>×§×•×‘×¥ &gt; ×©××•×¨ ×‘×©×</code></li>
      <li>×‘×—×¨×• ××ª <strong>×™×¢×“ ×”×©××™×¨×”</strong> ×‘××—×©×‘</li>
      <li>×‘×—×¨×• ×‘Ö¾<strong>×©××•×¨ ×›×¡×•×’</strong>: <code>CSV UTF-8 (Comma delimited) (*.csv)</code></li>
      <li>×©××¨×• ×‘×©× <code>template.csv</code> (××• ×©× ××—×¨ ×œ×‘×—×™×¨×ª×›×)</li>
      <li>×× × ×©××œ×ª× â€“ ××©×¨×• <strong>×”×—×œ×¤×” ×©×œ ×§×•×‘×¥ ×§×™×™×</strong></li>
    </ul>
  </li>
  <li>×—×–×¨×• ×œ××¢×¨×›×ª, ×œ×—×¦×• ×¢×œ <strong>ğŸ“ ×‘×—×™×¨×ª ×§×•×‘×¥</strong>, ×•×œ××—×¨ ××›×Ÿ ×¢×œ <strong>ğŸ“ˆ ×˜×¢×Ÿ × ×ª×•× ×™×</strong> ×œ×”×¢×œ××ª ×”×§×•×‘×¥ ×œ××¢×¨×›×ª.</li>
</ul>
            <input type="file" id="csvFile" accept=".csv" class="file-input">
			<br><br>
			<button onclick="loadData()" class="btn btn-primary">ğŸ“ˆ ×˜×¢×Ÿ × ×ª×•× ×™×</button>
			<button onclick="saveData()" class="btn btn-secondary">ğŸ’¾ ×©××•×¨ × ×ª×•× ×™×</button>
            <button onclick="loadSavedData()" class="btn btn-secondary">ğŸ“‚ ×˜×¢×Ÿ × ×ª×•× ×™× ×©××•×¨×™×</button>
            <button onclick="exportData()" class="btn btn-secondary">ğŸ“¤ ×™×™×¦× CSV</button>
			<button onclick="downloadTemplate()" class="btn btn-secondary">â¬‡ï¸ ×”×•×¨×“×ª ×ª×‘× ×™×ª</button>
            <div style="margin: 10px 0;">××•</div>
            <button onclick="openAddVenueModal()" class="btn btn-secondary">â• ×”×•×¡×£ ××§×•× ×™×“× ×™×ª</button>
            <br><br>
            

        </div>

        <!-- ×”×’×“×¨×•×ª ××™×©×™×•×ª -->
        <div class="upload-section" style="background: linear-gradient(135deg, #2ecc71 0%, #27ae60 100%);">
            <h3>âš™ï¸ ×”×’×“×¨×•×ª ××™×©×™×•×ª</h3>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-top: 15px;">
                <div>
                    <label style="display: block; margin-bottom: 5px;">×”×©× ×©×œ×š:</label>
                    <input type="text" id="userName" placeholder="×”×›× ×¡ ××ª ×©××š" style="width: 100%; padding: 8px; border-radius: 5px; border: none;">
                </div>
                <div>
                    <label style="display: block; margin-bottom: 5px;">××¡×¤×¨ ×˜×œ×¤×•×Ÿ:</label>
                    <input type="text" id="userPhone" placeholder="×”×›× ×¡ ××¡×¤×¨ ×˜×œ×¤×•×Ÿ" style="width: 100%; padding: 8px; border-radius: 5px; border: none;">
                </div>
                <div>
                    <label style="display: block; margin-bottom: 5px;">××™××™×™×œ:</label>
                    <input type="email" id="userEmail" placeholder="×”×›× ×¡ ××™××™×™×œ" style="width: 100%; padding: 8px; border-radius: 5px; border: none;">
                </div>
            </div>
            <br>
            <button onclick="saveSettings()" class="btn btn-primary">âœ… ×©××•×¨ ×”×’×“×¨×•×ª</button>
        </div>

        <div class="stats-dashboard">
            <div class="stat-card pending">
                <h3 id="pendingCount">0</h3>
                <p>×××ª×™× ×™× ×œ×¤× ×™×™×”</p>
            </div>
            <div class="stat-card contacted">
                <h3 id="contactedCount">0</h3>
                <p>× ×•×¦×¨ ×§×©×¨</p>
            </div>
            <div class="stat-card confirmed">
                <h3 id="confirmedCount">0</h3>
                <p>×‘×ª×”×œ×™×š</p>
            </div>
            <div class="stat-card closed">
                <h3 id="closedCount">0</h3>
                <p>× ×¡×’×¨</p>
            </div>
        </div>

        <div class="controls">
            <input type="text" id="searchFilter" placeholder="ğŸ” ×—×™×¤×•×© ××§×•×..." class="filter-input">
            <select id="cityFilter" class="filter-input">
                <option value="">×›×œ ×”×¢×¨×™×</option>
            </select>
            <select id="typeFilter" class="filter-input">
                <option value="">×›×œ ×”×¡×•×’×™×</option>
            </select>
            <select id="statusFilter" class="filter-input">
                <option value="">×›×œ ×”×¡×˜×˜×•×¡×™×</option>
                <option value="pending">×××ª×™×Ÿ ×œ×¤× ×™×™×”</option>
                <option value="contacted">× ×•×¦×¨ ×§×©×¨</option>
                <option value="confirmed">×‘×ª×”×œ×™×š</option>
                <option value="closed">× ×¡×’×¨</option>
            </select>
            <select id="regionFilter" class="filter-input">
                <option value="">×›×œ ×”××–×•×¨×™×</option>
                <option value="×¦×¤×•×Ÿ">×¦×¤×•×Ÿ</option>
                <option value="××¨×›×–">××¨×›×–</option>
                <option value="×“×¨×•×">×“×¨×•×</option>
            </select>
			<div style="display: flex; gap: 8px;">
  <button onclick="setViewMode('grid')" class="btn btn-secondary" id="gridBtn">ğŸ”² Grid</button>
  <button onclick="setViewMode('list')" class="btn btn-secondary" id="listBtn">ğŸ“‹ List</button>
</div>
        </div>

        <div id="venuesContainer">
            <!-- ×›××Ÿ ×™×•×¦×’×• ×”××§×•××•×ª -->
        </div>
    </div>

    <div class="ai-assistant" onclick="openAiAssistant()">
        ğŸ¤– ×¢×•×–×¨ AI
    </div>

    <!-- Modal ×œ×¢×•×–×¨ AI -->
    <div id="aiModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeAiAssistant()">&times;</span>
            <h2>ğŸ¤– ×¢×•×–×¨ AI ×œ× ×™×”×•×œ ×”×•×¤×¢×•×ª</h2>
            <div id="aiSuggestions"></div>
        </div>
    </div>

    <!-- Modal ×œ×”×•×“×¢×•×ª -->
    <div id="messageModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeMessageModal()">&times;</span>
            <h2>âœ‰ï¸ ×”×•×“×¢×” ××•×ª×××ª ××™×©×™×ª</h2>
            <div id="messageContent"></div>
        </div>
    </div>
	
	<!-- Modal ×›×¨×˜×™×¡ ××§×•× ××œ× -->
<div id="venueModal" class="modal">
  <div class="modal-content">
    <span class="close" onclick="closeVenueModal()">&times;</span>
    <h2 id="venueModalTitle">ğŸ  ×¤×¨×˜×™ ××§×•× ××œ×</h2>
    <br>
    <hr>
    <br>    
    <h4>ğŸ“‹ ×¤×¨×˜×™ ×”××§×•×</h4>
    <div id="venueModalInfo" style="margin-bottom:15px;"></div>

    <!-- ×ª×™×¢×•×“ ×©×™×—×” -->
    <h3>ğŸ—£ï¸ ×ª×™×¢×•×“ ×©×™×—×”</h3>
    <div id="venueModalHistory" style="max-height: 200px; overflow-y: auto; background: #f1f1f1; padding: 10px; border-radius: 10px; margin-bottom: 15px;"></div>
    <textarea id="venueModalText" placeholder="×›×ª×•×‘ ×›××Ÿ ××ª ×¤×¨×˜×™ ×”×©×™×—×”..." style="width: 100%; height: 100px; padding: 10px; border-radius: 10px; border: 1px solid #ccc;"></textarea>
    <br><br>
    <button class="btn btn-primary" onclick="saveVenueConversation()">ğŸ’¾ ×©××•×¨ ×ª×™×¢×•×“</button>

    <!-- ×¤×¢×•×œ×•×ª -->
    <h3 style="margin-top: 20px;">âš™ï¸ ×¤×¢×•×œ×•×ª</h3>
    <div style="display: flex; flex-wrap: wrap; gap: 10px; margin-top: 10px;">
      <select id="venueModalStatusSelect" class="status-select"></select>
      <button class="btn btn-primary" id="generateMessageBtn">âœ‰ï¸ ×¦×•×¨ ×”×•×“×¢×”</button>
      <button class="btn btn-secondary" id="callVenueBtn" style="display:none;">ğŸ“ ×”×ª×§×©×¨</button>
    </div>
  </div>
</div>

  <!-- ×”×•×¡×¤×ª ××§×•× ×™×“× ×™×ª ×›×•×œ×œ ××–×•×¨ -->
  <div id="addVenueModal" class="modal">
    <div class="modal-content">
      <span class="close" onclick="closeAddVenueModal()">&times;</span>
      <h2>â• ×”×•×¡×£ ××§×•× ×—×“×©</h2>
      <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-top: 15px;">
        <input type="text" id="manualName" placeholder="×©× ×”××§×•× *" style="padding:10px;border-radius:10px;border:1px solid #ccc">
        <input type="text" id="manualContact" placeholder="××™×© ×§×©×¨" style="padding:10px;border-radius:10px;border:1px solid #ccc">
        <input type="text" id="manualPhone" placeholder="×˜×œ×¤×•×Ÿ" style="padding:10px;border-radius:10px;border:1px solid #ccc">
        <input type="email" id="manualEmail" placeholder="××™××™×™×œ" style="padding:10px;border-radius:10px;border:1px solid #ccc">
        <select id="manualType" style="padding:10px;border-radius:10px;border:1px solid #ccc">
          <option value="">×‘×—×¨ ×¡×•×’ ××§×•×</option>
          <option>×‘×¨</option>
          <option>××¡×¢×“×”</option>
          <option>×‘×™×ª ×§×¤×”</option>
          <option>××œ×•×Ÿ</option>
          <option>××•×œ×</option>
          <option>×™×§×‘</option>
          <option>×’×œ×¨×™×”</option>
          <option>××—×¨</option>
        </select>
        <input type="text" id="manualCity" placeholder="×¢×™×¨" style="padding:10px;border-radius:10px;border:1px solid #ccc">
		<select id="manualRegion" style="padding:10px;border-radius:10px;border:1px solid #ccc">
          <option value="">×‘×—×¨ ××–×•×¨</option>
          <option>×¦×¤×•×Ÿ</option>
          <option>××¨×›×–</option>
          <option>×“×¨×•×</option>
        </select>
      </div>
      <br>
      <textarea id="manualNotes" placeholder="×”×¢×¨×•×ª..." style="width: 100%; height: 80px; padding: 10px; border-radius: 10px; border:1px solid #ccc;"></textarea>
      <br><br>
      <button onclick="addManualVenue()" class="btn btn-primary">âœ… ×”×•×¡×£ ×œ×¨×©×™××”</button>
    </div>
  </div>

    <script>
        let venues = [];
        let filteredVenues = [];
		let viewMode = 'grid';
        let userSettings = {
            name: '',
            phone: '',
            email: ''
        };

function getRegionByCity(city) {
    const regionMap = {
        // ×¦×¤×•×Ÿ
'× ×”×¨×™×”': '×¦×¤×•×Ÿ', '×¢×›×•': '×¦×¤×•×Ÿ', '×§×¨×™×™×ª ×©××•× ×”': '×¦×¤×•×Ÿ', '×¦×¤×ª': '×¦×¤×•×Ÿ',
'×˜×‘×¨×™×”': '×¦×¤×•×Ÿ', '× ×¦×¨×ª': '×¦×¤×•×Ÿ', '×—×™×¤×”': '×¦×¤×•×Ÿ', '×§×¨×™×•×ª': '×¦×¤×•×Ÿ',
'××•×¨×˜×œ': '×¦×¤×•×Ÿ', '××œ×•× ×™ ××‘×': '×¦×¤×•×Ÿ', '××œ×•× ×™×': '×¦×¤×•×Ÿ', '××˜×•×œ×”': '×¦×¤×•×Ÿ',
'×¨××© ×¤×™× ×”': '×¦×¤×•×Ÿ', '×›×¤×¨ ×ª×‘×•×¨': '×¦×¤×•×Ÿ', '××¢×œ×•×ª-×ª×¨×©×™×—×': '×¦×¤×•×Ÿ', '×©×œ×•××™': '×¦×¤×•×Ÿ',
'×›×¤×¨ ×•×¨×“×™×': '×¦×¤×•×Ÿ', '×›×¨××™××œ': '×¦×¤×•×Ÿ', '×›×¤×¨ ×’×œ×¢×“×™': '×¦×¤×•×Ÿ', '×¨××•×ª × ×¤×ª×œ×™': '×¦×¤×•×Ÿ',
'×’×•×œ×Ÿ': '×¦×¤×•×Ÿ', '××¨×•× ×’×•×œ×Ÿ': '×¦×¤×•×Ÿ', '×¨××ª ×™×©×™': '×¦×¤×•×Ÿ', '×™×§× ×¢× ×¢×™×œ×™×ª': '×¦×¤×•×Ÿ',
'×™×§× ×¢×': '×¦×¤×•×Ÿ', '×‘×™×ª ×©××Ÿ': '×¦×¤×•×Ÿ', '×‘×™×ª ×–×¨×–×™×¨': '×¦×¤×•×Ÿ', '×›×¤×¨ ×™××¡×™×£': '×¦×¤×•×Ÿ',
'×©×¤×¨×¢×': '×¦×¤×•×Ÿ', '×¢×™×œ×‘×•×Ÿ': '×¦×¤×•×Ÿ', '××’×“×œ': '×¦×¤×•×Ÿ', '×›×¤×¨ ×× ×“×': '×¦×¤×•×Ÿ',
'×“×™×¨ ×—× ×': '×¦×¤×•×Ÿ', '×¢×¨××‘×”': '×¦×¤×•×Ÿ', '×¡×—× ×™×Ÿ': '×¦×¤×•×Ÿ', '×× ×•×£': '×¦×¤×•×Ÿ',
'×ª××¨×ª': '×¦×¤×•×Ÿ', '×©×“×” ××™×œ×Ÿ': '×¦×¤×•×Ÿ', '×›×¤×¨ ×›××': '×¦×¤×•×Ÿ', '×’×•×© ×—×œ×‘': '×¦×¤×•×Ÿ',
'×‘×¨×¢×': '×¦×¤×•×Ÿ', '×‘×¨ ×™×•×—××™': '×¦×¤×•×Ÿ', '×—×•×¨×¤×™×©': '×¦×¤×•×Ÿ', '×¤×§×™×¢×™×Ÿ': '×¦×¤×•×Ÿ',
'×›×¡×¨× ×¡××™×¢': '×¦×¤×•×Ÿ', '×‘×™×ª ×’×Ÿ': '×¦×¤×•×Ÿ', '×”×¨ ×—×œ×•×¥': '×¦×¤×•×Ÿ', '×œ×‘×•×Ÿ': '×¦×¤×•×Ÿ',
'×¦×•×¨×™×ª': '×¦×¤×•×Ÿ', '×™×¢×¨×”': '×¦×¤×•×Ÿ', '×¢×‘×¨×•×Ÿ': '×¦×¤×•×Ÿ', '×›×‘×¨×™': '×¦×¤×•×Ÿ',
'×¢×™×Ÿ ×”××¤×¨×¥': '×¦×¤×•×Ÿ', '×œ×™××Ÿ': '×¦×¤×•×Ÿ', '×¨×’×‘×”': '×¦×¤×•×Ÿ', '×›×¤×¨ ××¡×¨×™×§': '×¦×¤×•×Ÿ',
'×©××¨×ª': '×¦×¤×•×Ÿ', '××™×œ×•×Ÿ': '×¦×¤×•×Ÿ', '××‘×™×¨×™×': '×¦×¤×•×Ÿ', '× ×˜×•×¢×”': '×¦×¤×•×Ÿ',
'×¤×¡×•×˜×”': '×¦×¤×•×Ÿ', '××¢×™×œ×™×': '×¦×¤×•×Ÿ', '×ª×¨×©×™×—×': '×¦×¤×•×Ÿ', '×¢×™×Ÿ ×™×¢×§×‘': '×¦×¤×•×Ÿ',
'×¤×§×™×¢×™×Ÿ ×—×“×©×”': '×¦×¤×•×Ÿ', '×™×•×‘×œ×™×': '×¦×¤×•×Ÿ', '×¦×•×¨×™××œ': '×¦×¤×•×Ÿ', '×¢××•×§×”': '×¦×¤×•×Ÿ',
'×“×œ×ª×•×Ÿ': '×¦×¤×•×Ÿ', '×›×¤×¨ ×©×××™': '×¦×¤×•×Ÿ', '×¢×™×Ÿ ×–×™×ª×™×': '×¦×¤×•×Ÿ', '×§×“×™×ª×': '×¦×¤×•×Ÿ',
'×¤×¨×•×“': '×¦×¤×•×Ÿ', '××™×¨×•×Ÿ': '×¦×¤×•×Ÿ', '×©×–×•×¨': '×¦×¤×•×Ÿ', '×¨×××”': '×¦×¤×•×Ÿ',
'×¢×™×Ÿ ××œ ××¡×“': '×¦×¤×•×Ÿ', '×¡×¤×¡×•×¤×”': '×¦×¤×•×Ÿ', '××¨×’×œ×™×•×ª': '×¦×¤×•×Ÿ', '××©×’×‘ ×¢×': '×¦×¤×•×Ÿ',
'×›×¤×¨ ×‘×œ×•×': '×¦×¤×•×Ÿ', '×©××¨ ×™×©×•×‘': '×¦×¤×•×Ÿ', '××™×™×œ×ª ×”×©×—×¨': '×¦×¤×•×Ÿ', '×—×•×œ×ª×”': '×¦×¤×•×Ÿ',
'×’×“×•×ª': '×¦×¤×•×Ÿ', '×’×•× ×Ÿ': '×¦×¤×•×Ÿ', '×©×“×” × ×—××™×”': '×¦×¤×•×Ÿ', '××¢×™×™×Ÿ ×‘×¨×•×š': '×¦×¤×•×Ÿ',
'×›×¤×¨ ×¡××œ×“': '×¦×¤×•×Ÿ', '×—××“×™×”': '×¦×¤×•×Ÿ', '× ×™×¨ ×“×•×“': '×¦×¤×•×Ÿ', '×©×“×™ ×ª×¨×•××•×ª': '×¦×¤×•×Ÿ',
'××¢×œ×” ×’×œ×‘×•×¢': '×¦×¤×•×Ÿ', '×›×¤×¨ ×¨×•×¤×™×Ÿ': '×¦×¤×•×Ÿ', '××¢×•×– ×—×™×™×': '×¦×¤×•×Ÿ', '×˜×™×¨×ª ×¦×‘×™': '×¦×¤×•×Ÿ',
'××‘× ×™ ××™×ª×Ÿ': '×¦×¤×•×Ÿ', '××œ×™ ×¢×“': '×¦×¤×•×Ÿ', '×—×¡×¤×™×Ÿ': '×¦×¤×•×Ÿ', '×§×¦×¨×™×Ÿ': '×¦×¤×•×Ÿ',
        
        // ××¨×›×–
'×ª×œ ××‘×™×‘': '××¨×›×–', '×¨××ª ×’×Ÿ': '××¨×›×–', '×’×‘×¢×ª×™×™×': '××¨×›×–', '×‘× ×™ ×‘×¨×§': '××¨×›×–',
'×¤×ª×— ×ª×§×•×”': '××¨×›×–', '×¨××© ×”×¢×™×Ÿ': '××¨×›×–', '×”×¨×¦×œ×™×”': '××¨×›×–', '×¨×¢× × ×”': '××¨×›×–',
'×›×¤×¨ ×¡×‘×': '××¨×›×–', '×”×•×“ ×”×©×¨×•×Ÿ': '××¨×›×–', '×¨××ª ×”×©×¨×•×Ÿ': '××¨×›×–', '××œ×¢×“': '××¨×›×–',
'×§×¨×™×ª ××•× ×•': '××¨×›×–', '××•×¨ ×™×”×•×“×”': '××¨×›×–', '×™×”×•×“ ××•× ×•×¡×•×Ÿ': '××¨×›×–', '×’× ×™ ×ª×§×•×”': '××¨×›×–',
'×¡×‘×™×•×Ÿ': '××¨×›×–', '×›×¤×¨ ×©××¨×™×”×•': '××¨×›×–', '×¨××ª ×¤× ×§×¡': '××¨×›×–', '×’×‘×¢×ª ×©××•××œ': '××¨×›×–',
'×ª×œ ××•× ×“': '××¨×›×–', '×§×“×™××” ×¦×•×¨×Ÿ': '××¨×›×–', '×¤×¨×“×¡×™×”': '××¨×›×–', '×‘×™×ª ×™×”×•×©×¢': '××¨×›×–',
'××‘×Ÿ ×™×”×•×“×”': '××¨×›×–', '×‘×™×ª ×™×¦×—×§': '××¨×›×–', '× ×•×•×” ×™××™×Ÿ': '××¨×›×–', '×ª×œ ×™×¦×—×§': '××¨×›×–',
'×¢×™×™× ×•×ª': '××¨×›×–', '××©××¨ ×”×©×‘×¢×”': '××¨×›×–', '×¦×¤×¨×™×”': '××¨×›×–', '×‘×™×ª ×“×’×Ÿ': '××¨×›×–',
'××–×•×¨': '××¨×›×–', '×’×‘×¢×ª ×‘×¨× ×¨': '××¨×›×–', '× ×¦×¨ ×¡×¨× ×™': '××¨×›×–', '×’× ×™ ×™×•×—× ×Ÿ': '××¨×›×–',
'×›×¤×¨ ×—×‘"×“': '××¨×›×–', '×™×“ ×¨××‘×': '××¨×›×–', '×¨××œ×”': '××¨×›×–', '×œ×•×“': '××¨×›×–',
'×©×•×”×': '××¨×›×–', '×‘×Ÿ ×©××Ÿ': '××¨×›×–', '××•×“×™×¢×™×Ÿ': '××¨×›×–', '××•×“×™×¢×™×Ÿ ×¢×™×œ×™×ª': '××¨×›×–',
'××›×‘×™×': '××¨×›×–', '×¨×¢×•×ª': '××¨×›×–', '×›×¤×¨ ×˜×¨×•××Ÿ': '××¨×›×–', '×‘×™×ª ×¢×¨×™×£': '××¨×›×–',
'×—×•×œ×•×Ÿ': '××¨×›×–', '×‘×ª ×™×': '××¨×›×–', '×¨××©×•×Ÿ ×œ×¦×™×•×Ÿ': '××¨×›×–', '× ×¡ ×¦×™×•× ×”': '××¨×›×–',
'×¨×—×•×‘×•×ª': '××¨×›×–', '×™×‘× ×”': '××¨×›×–', '×’×Ÿ ×™×‘× ×”': '××¨×›×–', '××–×›×¨×ª ×‘×ª×™×”': '××¨×›×–',
'×‘×™×ª ×¢×•×‘×“': '××¨×›×–', '×¤×œ××—×™×': '××¨×›×–', '× ×¢×Ÿ': '××¨×›×–', '×’×“×¨×”': '××¨×›×–',
'×‘××¨ ×™×¢×§×‘': '××¨×›×–', '××©××¨ ×“×•×“': '××¨×›×–', '×’×™× ×ª×•×Ÿ': '××¨×›×–', '×¤×ª×—×™×”': '××¨×›×–',
'×™×¦×™×¥': '××¨×›×–', '×™×¦×”×¨×•×Ÿ': '××¨×›×–', '×¨××•×ª ×××™×¨': '××¨×›×–', '×¡×ª×¨×™×”': '××¨×›×–',
'×—×¦×‘': '××¨×›×–', '×¢×–×¨×™×”': '××¨×›×–', '×—×•×œ×“×”': '××¨×›×–', '×›×¤×¨ ×‘×™×œ×•': '××¨×›×–',
'×§×¨×™×ª ×¢×§×¨×•×Ÿ': '××¨×›×–', '×—×¤×¥ ×—×™×™×': '××¨×›×–', '×‘×™×ª ×—×©××•× ××™': '××¨×›×–', '×›×¤×¨ ×‘×Ÿ × ×•×Ÿ': '××¨×›×–',
'××©××¨ ××™×™×œ×•×Ÿ': '××¨×›×–', '× ×¢×œ×”': '××¨×›×–', '×©×™×œ×ª': '××¨×›×–', '×œ×¤×™×“': '××¨×›×–',
'×›×¤×¨ ×¨×•×ª': '××¨×›×–', '×©×•×”× ××–×¨×—': '××¨×›×–', '× ×™×¨ ×¦×‘×™': '××¨×›×–', '×ª×¢×•×–': '××¨×›×–',
'×™×’×œ': '××¨×›×–', '××—×™×¢×–×¨': '××¨×›×–', '×‘×™×ª × ×—××™×”': '××¨×›×–', '×‘×¨×§×ª': '××¨×›×–',
'×¦×•×¨ ×™×¦×—×§': '××¨×›×–', '×¦×•×¨ × ×ª×Ÿ': '××¨×›×–', '× ×—×œ×™×': '××¨×›×–', '×›×¤×¨ ××¢×©': '××¨×›×–',
'×’×‘×¢×ª ×›"×—': '××¨×›×–', '×’× ×™ ×”×“×¨': '××¨×›×–', '×™×¨×—×™×‘': '××¨×›×–', '× ×•×¤×š': '××¨×›×–',
'×¢×“× ×™×': '××¨×›×–', '×‘× ×™ ×¢×˜×¨×•×ª': '××¨×›×–', '×‘× ×™ ×“×¨×•×¨': '××¨×›×–', '×‘×ª ×—×Ÿ': '××¨×›×–',
        
        // ×“×¨×•×
'×‘××¨ ×©×‘×¢': '×“×¨×•×', '×“×™××•× ×”': '×“×¨×•×', '×™×¨×•×—×': '×“×¨×•×', '×¢×¨×“': '×“×¨×•×',
'××•×¤×§×™×': '×“×¨×•×', '× ×ª×™×‘×•×ª': '×“×¨×•×', '×©×“×¨×•×ª': '×“×¨×•×', '×¨×”×˜': '×“×¨×•×',
'×—×•×¨×”': '×“×¨×•×', '×ª×œ ×©×‘×¢': '×“×¨×•×', '×œ×§×™×”': '×“×¨×•×', '×›×¡×™×¤×”': '×“×¨×•×',
'×¢×¨×¢×¨×” ×‘× ×’×‘': '×“×¨×•×', '×©×’×‘ ×©×œ×•×': '×“×¨×•×', '××‘×• ×ª×œ×•×œ': '×“×¨×•×', '××œ ×§×¡×•×': '×“×¨×•×',
'×ª×¤×¨×—': '×“×¨×•×', '×ª×œ××™ ×‘×™×œ×•': '×“×¨×•×', '×ª×œ××™×': '×“×¨×•×', '×ª×§×•××”': '×“×¨×•×',
'×–××¨×ª': '×“×¨×•×', '×©×•×§×“×”': '×“×¨×•×', '×‘× ×™ ×¢×™×©': '×“×¨×•×', '××¡×œ×•×œ': '×“×¨×•×',
'×©×•×‘×”': '×“×¨×•×', '× ×™×¨ ×™×¦×—×§': '×“×¨×•×', '× ×™×¨×™×': '×“×¨×•×', '××™×‘×™×': '×“×¨×•×',
'×›×¤×¨ ×¢×–×”': '×“×¨×•×', '× ×—×œ ×¢×•×–': '×“×¨×•×', '×¢×œ×•××™×': '×“×¨×•×', '×—×•×œ×™×ª': '×“×¨×•×',
'×¡×•×¤×”': '×“×¨×•×', '×¤×¨×™ ×’×Ÿ': '×“×¨×•×', '×™×ª×“': '×“×¨×•×', '××‘×©×œ×•×': '×“×¨×•×',
'×©×“×” × ×™×¦×Ÿ': '×“×¨×•×', '×“×§×œ': '×“×¨×•×', '×¢××™×¢×•×–': '×“×¨×•×', '××‘×˜×—×™×': '×“×¨×•×',
'×¦×•×—×¨': '×“×¨×•×', '×©×œ×•××™×ª': '×“×¨×•×', '×™×©×¢': '×“×¨×•×', '×ª×•×©×™×”': '×“×¨×•×',
'×‘××¨×™': '×“×¨×•×', '××¤×œ×¡×™×': '×“×¨×•×', '×’×‘×™×': '×“×¨×•×', '× ×™×¨ ×¢×': '×“×¨×•×',
'×©×“×™ ××‘×¨×”×': '×“×¨×•×', '×©×“×” ×¦×‘×™': '×“×¨×•×', '×¨×¢×™×': '×“×¨×•×', '××’×Ÿ': '×“×¨×•×',
'×¢×™×Ÿ ×”×‘×©×•×¨': '×“×¨×•×', '×¢×™×Ÿ ×”×©×œ×•×©×”': '×“×¨×•×', '×™×ª×™×¨': '×“×¨×•×', '×©× ×™ ×œ×™×‘× ×”': '×“×¨×•×',
'×›×¨××™×': '×“×¨×•×', '×›×•×›×‘ ××™×›××œ': '×“×¨×•×', '× ×™×¨ ×¢×•×–': '×“×¨×•×', '× ×•×•×”': '×“×¨×•×',
'×¢×•××¨': '×“×¨×•×', '×œ×”×‘×™×': '×“×¨×•×', '××™×ª×¨': '×“×¨×•×', '×©×’×‘ ×©×œ×•× ××¢×¨×‘': '×“×¨×•×',
'× ×‘×˜×™×': '×“×¨×•×', '×©×—×¨': '×“×¨×•×', '×ª×œ ×¢×¨×“': '×“×¨×•×', '×›×¡×™×£': '×“×¨×•×',
'×¢×™×“×Ÿ': '×“×¨×•×', '×¢×™×Ÿ ×™×”×‘': '×“×¨×•×', '×¦×•×¤×¨': '×“×¨×•×', '×—×¦×‘×”': '×“×¨×•×',
'×¡×¤×™×¨': '×“×¨×•×', '×¤××¨×Ÿ': '×“×¨×•×', '× ×•×•×” ×–×•×”×¨': '×“×¨×•×', '×¦×•×§×™×': '×“×¨×•×',
'××©××‘×™ ×©×“×”': '×“×¨×•×', '×¨×‘×™×‘×™×': '×“×¨×•×', '×¨××ª × ×’×‘': '×“×¨×•×', '×©×™×‘×•×œ×™×': '×“×¨×•×',
'×˜× × ×¢×•××¨×™×': '×“×¨×•×', '××œ×™×œ×•×ª': '×“×¨×•×', '× ×™×¨ ×‘× ×™×': '×“×¨×•×', '×©×“×” ××©×”': '×“×¨×•×',
'×©×“×” ×™×•××‘': '×“×¨×•×', '× ×™×¨ ×’×œ×™×': '×“×¨×•×', '×‘×™×ª ×©×§××”': '×“×¨×•×', '×’×‘×¢×•×œ×™×': '×“×¨×•×',
'× ×™×¨ ×™×©×¨××œ': '×“×¨×•×', '×’×™×œ×ª': '×“×¨×•×', '×ª×•×©×™×” ××–×¨×—': '×“×¨×•×', '××•×©×‘×™ ×—×•×£ ××©×§×œ×•×Ÿ': '×“×¨×•×',
'××©×§×œ×•×Ÿ': '×“×¨×•×', '×§×¨×™×ª ×’×ª': '×“×¨×•×', '×§×¨×™×ª ××œ××›×™': '×“×¨×•×', '××©×“×•×“': '×“×¨×•×',
'×‘×™×ª ×”×’×“×™': '×“×¨×•×', '×©×“×” ×¢×•×–×™×”×•': '×“×¨×•×', '×××•× ×™×': '×“×¨×•×', '×›×¤×¨ ×•×¨×‘×•×¨×’': '×“×¨×•×'
    };
    
    return regionMap[city] || '';
}

        // ×˜×¢×™× ×ª ×”×’×“×¨×•×ª ××©×ª××©
        function loadUserSettings() {
            const saved = localStorage.getItem('gigBookingSettings');
            if (saved) {
                userSettings = JSON.parse(saved);
                document.getElementById('userName').value = userSettings.name || '';
                document.getElementById('userPhone').value = userSettings.phone || '';
                document.getElementById('userEmail').value = userSettings.email || '';
            }
        }

        // ×©××™×¨×ª ×”×’×“×¨×•×ª ××©×ª××©
        function saveSettings() {
            userSettings.name = document.getElementById('userName').value;
            userSettings.phone = document.getElementById('userPhone').value;
            userSettings.email = document.getElementById('userEmail').value;
            
            localStorage.setItem('gigBookingSettings', JSON.stringify(userSettings));
            alert('âœ… ×”×’×“×¨×•×ª × ×©××¨×• ×‘×”×¦×œ×—×”!');
        }
		
		// ×¤×•× ×§×¦×™×” ×œ×©×™× ×•×™ ×ª×¦×•×’×”
        function setViewMode(mode) {
        viewMode = mode;
        document.getElementById('gridBtn').style.opacity = (mode === 'grid') ? '1' : '0.6';
        document.getElementById('listBtn').style.opacity = (mode === 'list') ? '1' : '0.6';
        renderVenues();
        }

        // ×©××™×¨×ª × ×ª×•× ×™×
        function saveData() {
            if (venues.length === 0) {
                alert('××™×Ÿ × ×ª×•× ×™× ×œ×©××™×¨×”');
                return;
            }
            
            const dataToSave = {
                venues: venues,
                timestamp: new Date().toLocaleString('he-IL')
            };
            
            localStorage.setItem('gigBookingData', JSON.stringify(dataToSave));
            alert('âœ… ×”× ×ª×•× ×™× × ×©××¨×• ×‘×”×¦×œ×—×”!');
        }

        // ×˜×¢×™× ×ª × ×ª×•× ×™× ×©××•×¨×™×
        function loadSavedData() {
            const savedData = localStorage.getItem('gigBookingData');
            if (!savedData) {
                alert('×œ× × ××¦××• × ×ª×•× ×™× ×©××•×¨×™×');
                return;
            }
            
            try {
                const data = JSON.parse(savedData);
                venues = data.venues || [];
                filteredVenues = [...venues];
                
                updateFilters();
                renderVenues();
                updateStats();
                
                alert(`âœ… × ×ª×•× ×™× × ×˜×¢× ×• ×‘×”×¦×œ×—×”!\n× ×©××¨ ×‘: ${data.timestamp}\n××¡×¤×¨ ××§×•××•×ª: ${venues.length}`);
            } catch (error) {
                alert('×©×’×™××” ×‘×˜×¢×™× ×ª ×”× ×ª×•× ×™× ×”×©××•×¨×™×');
            }
        }

        // ×™×™×¦×•× × ×ª×•× ×™× ×œ-CSV
        function exportData() {
            if (venues.length === 0) {
                alert('××™×Ÿ × ×ª×•× ×™× ×œ×™×™×¦×•×');
                return;
            }
            
            const csvContent = [
                headers.join(','),
            ].join('\n');
            
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = `venues_export_${new Date().toISOString().split('T')[0]}.csv`;
            link.click();
        }

        function loadData() {
            const fileInput = document.getElementById('csvFile');
            const textInput = document.getElementById('csvData');
            
            let csvContent = '';
            
            if (fileInput.files.length > 0) {
                const file = fileInput.files[0];
                const reader = new FileReader();
                reader.onload = function(e) {
                    csvContent = e.target.result;
                    parseCSV(csvContent);
                };
                reader.readAsText(file);
            } else if (textInput.value.trim()) {
                csvContent = textInput.value.trim();
                parseCSV(csvContent);
            } else {
                // ×˜×¢×Ÿ ×“××” × ×ª×•× ×™× ×œ×“×•×’××”
                parseCSV(sampleData);
            }
        }

function parseCSV(csvContent) {
    const lines = csvContent.trim().split('\n');
    const headers = lines[0].split(',');
    venues = [];

    for (let i = 1; i < lines.length; i++) {
        const line = lines[i].trim();
        if (!line) continue;

        const values = line.split(',');
        if (values.length < 8) {
            console.warn(`×©×•×¨×” ${i + 1} ×—×¡×¨×” ×¢××•×“×•×ª:`, line);
            continue;
        }

        const venue = {
            id: i,
            name: values[0] || '',
			type: values[1] || '',
			city: values[2] || '',
			region: values[3] || '',
            contact: values[4] || '',
            phone: values[5] || '',
            email: values[6] || '', 
            notes: values[7] || '',
            
            status: 'pending',
            lastContact: null,
            nextFollowUp: null
        };

        venues.push(venue);
    }

    filteredVenues = [...venues];
    updateFilters();
    renderVenues();
    updateStats();
}

function renderVenues() {
  const container = document.getElementById('venuesContainer');
  container.innerHTML = '';

  if (viewMode === 'grid') {
    container.className = 'venues-grid';
  } else {
    container.className = ''; // ××™×Ÿ ×¢×™×¦×•×‘ ×’×¨×™×“ ×‘×œ×™×¡×˜
  }

  filteredVenues.forEach(venue => {
    const venueCard = document.createElement('div');
    venueCard.className = `venue-card ${venue.status}`;
    venueCard.style.cursor = 'pointer';

if (viewMode === 'grid') {
  venueCard.innerHTML = `
    <div class="venue-name">${venue.name}</div>
    ${getConversationIcon(venue.id)}
    <div class="venue-info">
      ${venue.contact ? `<div class="info-row">ğŸ‘¤ ${venue.contact}</div>` : ''}
      ${venue.phone ? `<div class="info-row">ğŸ“ ${venue.phone}</div>` : ''}
      ${venue.email ? `<div class="info-row">ğŸ“§ ${venue.email}</div>` : ''}
      ${venue.type ? `<div class="info-row">ğŸ¢ ${venue.type}</div>` : ''}
      ${venue.city ? `<div class="info-row">ğŸ“ ${venue.city}</div>` : ''}
      ${venue.region ? `<div class="info-row">ğŸ—ºï¸ ${venue.region}</div>` : ''}
    </div>
  `;

  // ×›××Ÿ ×¢×•×©×™× ××ª ×”×›×¨×˜×™×¡ ×§×œ×™×§×‘×™×œ×™:
  venueCard.onclick = function() {
    openVenueCard(venue.id);
  };
}

	else {
      // ×ª×¦×•×’×ª LIST
      venueCard.style.display = 'flex';
      venueCard.style.flexDirection = 'row';
      venueCard.style.alignItems = 'center';
      venueCard.style.justifyContent = 'space-between';
      venueCard.style.padding = '15px';
      venueCard.style.marginBottom = '10px';

      venueCard.innerHTML = `
        <div>
          <div class="venue-name" style="margin-bottom:5px;">${venue.name}</div>
          <div class="info-row">${venue.contact || ''} â€¢ ${venue.phone || ''}</div>
          <div class="info-row">${venue.type || ''} â€¢ ${venue.city || ''} â€¢ ${venue.region || ''}</div>
        </div>
        <div>
        </div>
      `;
    }

    container.appendChild(venueCard);
  });
}

        function updateStatus(venueId, newStatus) {
            const venue = venues.find(v => v.id === venueId);
            if (venue) {
                venue.status = newStatus;
                venue.lastContact = new Date().toLocaleDateString('he-IL');
                
                // ×§×‘×¢ ××•×¢×“ ××¢×§×‘ ×”×‘×
                const followUpDays = {
                    'contacted': 3,
                    'confirmed': 7,
                    'closed': 0
                };
                
                if (followUpDays[newStatus] > 0) {
                    const followUp = new Date();
                    followUp.setDate(followUp.getDate() + followUpDays[newStatus]);
                    venue.nextFollowUp = followUp.toLocaleDateString('he-IL');
                }
                
                updateStats();
                renderVenues();
            }
        }

        function generateMessage(venueId) {
            const venue = venues.find(v => v.id === venueId);
            if (!venue) return;

            // ×•×“× ×©×™×© ×”×’×“×¨×•×ª ××©×ª××©
            if (!userSettings.name) {
                alert('×× × ×”×›× ×¡ ××ª ×”×¤×¨×˜×™× ×”××™×©×™×™× ×©×œ×š ×‘×—×œ×§ ×”×”×’×“×¨×•×ª ×œ××¢×œ×”');
                return;
            }

            const messages = {
                initial: `×©×œ×•×, ${venue.contact || '××” ×©×œ×•××š?'}

×× ×™ ${userSettings.name}, ××•×–×™×§××™ ××§×¦×•×¢×™ ×¢× × ×™×¡×™×•×Ÿ ×¢×©×™×¨ ×‘×”×•×¤×¢×•×ª.

×¨××™×ª×™ ××ª ${venue.name} ×•×× ×™ ××××™×Ÿ ×©×”××§×•× ×©×œ×›× ×™×”×™×” ××•×©×œ× ×œ×§×”×œ ×©×œ×™.

×× ×™ ××¦×™×¢ ×”×•×¤×¢×” ××™×›×•×ª×™×ª ×©×ª×•×¡×™×£ ××•×•×™×¨×” ××™×•×—×“×ª ×œ××§×•×:
ğŸµ ×¨×¤×¨×˜×•××¨ ××’×•×•×Ÿ ×•××•×ª×× ×œ×§×”×œ
ğŸ¤ ×¦×™×•×“ ××§×¦×•×¢×™ ×•××™×›×•×ª×™  
â­ ×”××œ×¦×•×ª ××¢×•×œ×•×ª ×××§×•××•×ª ×§×•×“××™×

××©××— ×œ×ª×× ×¤×’×™×©×” ×§×¦×¨×” ××• ×©×™×—×ª ×˜×œ×¤×•×Ÿ ×œ×¤×¨×˜×™×.

×‘×›×‘×•×“ ×¨×‘,
${userSettings.name}
${userSettings.phone}
${userSettings.email}`,

                followUp: `×©×œ×•× ×©×•×‘,

×¨×¦×™×ª×™ ×œ×¢×§×•×‘ ××—×¨×™ ×”×”×•×“×¢×” ×©×©×œ×—×ª×™ ×œ×¤× ×™ ×›××” ×™××™× ×‘× ×•×’×¢ ×œ×”×•×¤×¢×” ×‘-${venue.name}.

×× ×™ ×–××™×Ÿ ×œ×›×œ ×©××œ×” ××• ×”×‘×”×¨×” × ×•×¡×¤×ª.

×”×× × ×•×›×œ ×œ×ª×× ×©×™×—×” ×§×¦×¨×” ×”×©×‘×•×¢?

×ª×•×“×” ×¨×‘×”,
${userSettings.name}
${userSettings.phone}`
            };

            const messageType = venue.status === 'pending' ? 'initial' : 'followUp';
            const message = messages[messageType];

            document.getElementById('messageContent').innerHTML = `
                <h3>${venue.name}</h3>
                <textarea id="messageText" style="width: 100%; height: 300px; padding: 15px; border-radius: 10px; border: 2px solid #ddd;">${message}</textarea>
                <br><br>
                <button class="btn btn-primary" onclick="copyMessage(this)">ğŸ“‹ ×”×¢×ª×§ ×”×•×“×¢×”</button>
                ${venue.email ? `<button class="btn btn-secondary" onclick="openEmail('${venue.email}', '${encodeURIComponent('×”×¦×¢×” ×œ×”×•×¤×¢×” ×‘-' + venue.name)}', '${encodeURIComponent(message)}')">ğŸ“§ ×©×œ×— ×‘××™××™×™×œ</button>` : ''}
                ${venue.phone ? `<button class="btn btn-secondary" onclick="openWhatsApp('${venue.phone}', '${encodeURIComponent(message)}')">ğŸ’¬ ×©×œ×— ×‘×•×•××˜×¡××¤</button>` : ''}
            `;
            
            document.getElementById('messageModal').style.display = 'block';
        }

        function copyMessage(button) {
            const textarea = document.getElementById('messageText');
            textarea.select();
            document.execCommand('copy');
            button.textContent = 'âœ… ×”×•×¢×ª×§!';
            setTimeout(() => {
                button.textContent = 'ğŸ“‹ ×”×¢×ª×§ ×”×•×“×¢×”';
            }, 2000);
        }

        function openEmail(email, subject, body) {
            window.open(`mailto:${email}?subject=${subject}&body=${body}`);
        }

        function openWhatsApp(phone, message) {
            const cleanPhone = phone.replace(/[^0-9]/g, '');
            const whatsappUrl = `https://wa.me/972${cleanPhone.startsWith('0') ? cleanPhone.substring(1) : cleanPhone}?text=${message}`;
            window.open(whatsappUrl);
        }

        function callVenue(phone) {
            if (confirm(`×”×ª×§×©×¨ ×œ-${phone}?`)) {
                window.open(`tel:${phone}`);
            }
        }

        function updateFilters() {
            // ×¢×“×›×Ÿ ××¡× × ×™ ×¢×™×¨
            const cities = [...new Set(venues.map(v => v.city).filter(c => c))];
            const cityFilter = document.getElementById('cityFilter');
            cityFilter.innerHTML = '<option value="">×›×œ ×”×¢×¨×™×</option>';
            cities.forEach(city => {
                cityFilter.innerHTML += `<option value="${city}">${city}</option>`;
            });

            // ×¢×“×›×Ÿ ××¡× × ×™ ×¡×•×’
            const types = [...new Set(venues.map(v => v.type).filter(t => t))];
            const typeFilter = document.getElementById('typeFilter');
            typeFilter.innerHTML = '<option value="">×›×œ ×”×¡×•×’×™×</option>';
            types.forEach(type => {
                typeFilter.innerHTML += `<option value="${type}">${type}</option>`;
            });
        }

        function updateStats() {
            const stats = venues.reduce((acc, venue) => {
                acc[venue.status] = (acc[venue.status] || 0) + 1;
                return acc;
            }, {});

            document.getElementById('pendingCount').textContent = stats.pending || 0;
            document.getElementById('contactedCount').textContent = stats.contacted || 0;
            document.getElementById('confirmedCount').textContent = stats.confirmed || 0;
            document.getElementById('closedCount').textContent = stats.closed || 0;
        }

        function applyFilters() {
            const searchFilter = document.getElementById('searchFilter').value.toLowerCase();
            const cityFilter = document.getElementById('cityFilter').value;
            const typeFilter = document.getElementById('typeFilter').value;
            const statusFilter = document.getElementById('statusFilter').value;
            const regionFilter = document.getElementById('regionFilter').value;

            filteredVenues = venues.filter(venue => {
                return (!searchFilter || venue.name.toLowerCase().includes(searchFilter)) &&
                       (!cityFilter || venue.city === cityFilter) &&
                       (!typeFilter || venue.type === typeFilter) &&
                       (!statusFilter || venue.status === statusFilter) &&
                       (!regionFilter || venue.region === regionFilter);
            });

            renderVenues();
        }

        function openAiAssistant() {
            const suggestions = [
                "ğŸ¯ ×”××§×•××•×ª ×¢× ×”×¤×•×˜× ×¦×™××œ ×”×’×‘×•×” ×‘×™×•×ª×¨ ×”×©×‘×•×¢",
                "ğŸ“ˆ × ×™×ª×•×— ×‘×™×¦×•×¢×™× - ××™×œ×• ×’×™×©×•×ª ×¢×•×‘×“×•×ª ×”×›×™ ×˜×•×‘",
                "â° ×ª×–×›×•×¨×•×ª ××¢×§×‘ - ×œ××™ ×›×“××™ ×œ×—×–×•×¨ ×”×™×•×",
                "ğŸ’¬ ×˜×™×¤×™× ×œ×©×™×¤×•×¨ ×”×•×“×¢×•×ª",
                "ğŸ“Š ×“×•×— ×”×ª×§×“××•×ª ×©×‘×•×¢×™"
            ];

            document.getElementById('aiSuggestions').innerHTML = `
                <p>××™×š ×× ×™ ×™×›×•×œ ×œ×¢×–×•×¨ ×œ×š ×œ×”×¦×œ×™×— ×™×•×ª×¨ ×‘×¡×’×™×¨×ª ×”×•×¤×¢×•×ª?</p>
                <ul>
                    ${suggestions.map(s => `<li style="margin: 10px 0; cursor: pointer; padding: 10px; background: #f8f9fa; border-radius: 5px;" onclick="handleAiSuggestion('${s}')">${s}</li>`).join('')}
                </ul>
            `;
            
            document.getElementById('aiModal').style.display = 'block';
        }

        function handleAiSuggestion(suggestion) {
            // ×›××Ÿ ×ª×•×›×œ ×œ×”×•×¡×™×£ ×œ×•×’×™×§×” ××ª×§×“××ª ×™×•×ª×¨
            alert('×ª×›×•× ×” ×–×• ×ª×¤×•×ª×— ×‘×”××©×š - ' + suggestion);
        }

        function closeAiAssistant() {
            document.getElementById('aiModal').style.display = 'none';
        }

        function closeMessageModal() {
            document.getElementById('messageModal').style.display = 'none';
        }

function openConversation(venueId) {
  currentConversationVenueId = venueId;
  const historyDiv = document.getElementById('conversationHistory');
  const data = JSON.parse(localStorage.getItem('venueChats') || '{}');
  const history = data[venueId] || [];
  const venue = venues.find(v => v.id === venueId);
  document.getElementById('venueNotes').innerHTML = venue?.notes
    ? `<strong>ğŸ“Œ ×”×¢×¨×•×ª:</strong> ${venue.notes}`
    : '<strong>ğŸ“Œ ×”×¢×¨×•×ª:</strong> ××™×Ÿ ×”×¢×¨×•×ª ×œ××§×•× ×–×”.';
  
  historyDiv.innerHTML = history.map(chat => `
      <div style="margin-bottom: 8px;">
        <div style="font-size: 0.85em; color: gray;">ğŸ“… ${chat.time}</div>
        <div>${chat.text}</div>
      </div>
  `).join('') || '<div>××™×Ÿ ×ª×™×¢×•×“ ×§×•×“×</div>';

  document.getElementById('conversationText').value = '';
  document.getElementById('conversationModal').style.display = 'block';
}

// ---- ×¢×›×©×™×• ××—×•×¥ ×œ×¤×•× ×§×¦×™×” ----



function openVenueCard(venueId) {
  currentConversationVenueId = venueId;
  const venue = venues.find(v => v.id === venueId);
  if (!venue) return;

  // Title
  document.getElementById('venueModalTitle').innerText = `ğŸ  ${venue.name}`;

  // Venue info
  document.getElementById('venueModalInfo').innerHTML = `
    <div class="info-row">ğŸ‘¤ ××™×© ×§×©×¨: ${venue.contact || '-'}</div>
    <div class="info-row">ğŸ“ ×˜×œ×¤×•×Ÿ: ${venue.phone || '-'}</div>
    <div class="info-row">ğŸ“§ ××™××™×™×œ: ${venue.email || '-'}</div>
    <div class="info-row">ğŸ¢ ×¡×•×’: ${venue.type || '-'}</div>
    <div class="info-row">ğŸ“ ×¢×™×¨: ${venue.city || '-'}</div>
    <div class="info-row">ğŸ—ºï¸ ××–×•×¨: ${venue.region || '-'}</div>
    <div class="info-row">ğŸ“Œ ×”×¢×¨×•×ª: ${venue.notes || '-'}</div>
  `;

  // Notes
  document.getElementById('venueModalNotes').innerHTML = venue?.notes
    ? `<strong>ğŸ“Œ ×”×¢×¨×•×ª:</strong> ${venue.notes}`
    : '<strong>ğŸ“Œ ×”×¢×¨×•×ª:</strong> ××™×Ÿ ×”×¢×¨×•×ª ×œ××§×•× ×–×”.';

  // Conversation history
  const historyDiv = document.getElementById('venueModalHistory');
  const data = JSON.parse(localStorage.getItem('venueChats') || '{}');
  const history = data[venueId] || [];
  historyDiv.innerHTML = history.map(chat => `
      <div style="margin-bottom: 8px;">
        <div style="font-size: 0.85em; color: gray;">ğŸ“… ${chat.time}</div>
        <div>${chat.text}</div>
      </div>
  `).join('') || '<div>××™×Ÿ ×ª×™×¢×•×“ ×§×•×“×</div>';

  document.getElementById('venueModalText').value = '';

  // Status select
  document.getElementById('venueModalStatusSelect').innerHTML = `
    <option value="pending" ${venue.status === 'pending' ? 'selected' : ''}>×××ª×™×Ÿ ×œ×¤× ×™×™×”</option>
    <option value="contacted" ${venue.status === 'contacted' ? 'selected' : ''}>× ×•×¦×¨ ×§×©×¨</option>
    <option value="confirmed" ${venue.status === 'confirmed' ? 'selected' : ''}>×‘×ª×”×œ×™×š</option>
    <option value="closed" ${venue.status === 'closed' ? 'selected' : ''}>× ×¡×’×¨</option>
  `;
  document.getElementById('venueModalStatusSelect').onchange = function() {
    updateStatus(venueId, this.value);
  };

  // Generate message button
  document.getElementById('generateMessageBtn').onclick = function() {
    document.getElementById('venueModal').style.display = 'none';
    generateMessage(venueId);
  };

  // Call button
  if (venue.phone) {
    document.getElementById('callVenueBtn').style.display = '';
    document.getElementById('callVenueBtn').onclick = function() {
      callVenue(venue.phone);
    };
  } else {
    document.getElementById('callVenueBtn').style.display = 'none';
  }

  // Open modal
  document.getElementById('venueModal').style.display = 'block';
}



function closeConversationModal() {
    document.getElementById('conversationModal').style.display = 'none';
}


function saveConversation() {
    const text = document.getElementById('conversationText').value.trim();
    if (!text) {
        alert('×œ× × ×™×ª×Ÿ ×œ×©××•×¨ ×©×™×—×” ×¨×™×§×”');
        return;
    }

    const data = JSON.parse(localStorage.getItem('venueChats') || '{}');
    if (!data[currentConversationVenueId]) data[currentConversationVenueId] = [];

    data[currentConversationVenueId].push({
        text,
        time: new Date().toLocaleString('he-IL')
    });

    localStorage.setItem('venueChats', JSON.stringify(data));

    // ×¢×“×›×•×Ÿ ×”×™×¡×˜×•×¨×™×™×ª ×©×™×—×” ×‘×ª×•×š ×”-Modal
    const historyDiv = document.getElementById('conversationHistory');
    const history = data[currentConversationVenueId];
    historyDiv.innerHTML = history.map(chat => `
        <div style="margin-bottom: 8px;">
            <div style="font-size: 0.85em; color: gray;">ğŸ“… ${chat.time}</div>
            <div>${chat.text}</div>
        </div>
    `).join('');

    document.getElementById('conversationText').value = '';

    renderVenues();

    // ×¡×’×•×¨ ××ª ×”××•×“×œ ×¨×§ ×× ×¦×¨×™×š:
    if (document.getElementById('conversationModal').style.display === 'block') {
        closeConversationModal();
    } else if (document.getElementById('venueModal').style.display === 'block') {
        closeVenueModal();
    }
}


// ×¡×™××Ÿ ×©×œ ×ª×™×¢×•×“ ×©×™×—×”
function getConversationIcon(venueId) {
    const data = JSON.parse(localStorage.getItem('venueChats') || '{}');
    if (data[venueId] && data[venueId].length > 0) {
        return `<div class="chat-icon" title="×™×© ×ª×™×¢×•×“ ×©×™×—×”">ğŸ’¬</div>`;
    }
    return '';
}

let currentConversationVenueId = null;

        // Event listeners
        document.getElementById('searchFilter').addEventListener('input', applyFilters);
        document.getElementById('cityFilter').addEventListener('change', applyFilters);
        document.getElementById('typeFilter').addEventListener('change', applyFilters);
        document.getElementById('statusFilter').addEventListener('change', applyFilters);
        document.getElementById('manualRegion').addEventListener('change', applyFilters);
		document.getElementById('regionFilter').addEventListener('change', applyFilters);

        // ××ª×—×•×œ ×”××¢×¨×›×ª
        window.onload = function() {
            loadUserSettings();
            updateStats();
        };

        // ×¡×’×™×¨×ª ××•×“×œ×™× ×¢× ESC
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeAiAssistant();
                closeMessageModal();
            }
        });

function openAddVenueModal() {
  document.getElementById('addVenueModal').style.display = 'block';
}
function closeAddVenueModal() {
  document.getElementById('addVenueModal').style.display = 'none';
}
function addManualVenue() {
  const name = document.getElementById('manualName').value.trim();
  if (!name) {
    alert('×—×•×‘×” ×œ×”×–×™×Ÿ ×©× ××§×•×');
    return;
  }
  const newVenue = {
    id: Date.now(),
    name,
    contact: document.getElementById('manualContact').value.trim(),
    phone: document.getElementById('manualPhone').value.trim(),
    email: document.getElementById('manualEmail').value.trim(),
    type: document.getElementById('manualType').value,
    city: document.getElementById('manualCity').value.trim(),
    notes: document.getElementById('manualNotes').value.trim(),
    region: document.getElementById('manualRegion').value.trim() || getRegionByCity(document.getElementById('manualCity').value.trim()),
    status: 'pending',
    lastContact: null,
    nextFollowUp: null
  };
  venues.push(newVenue);
  filteredVenues = [...venues];
  updateFilters();
  renderVenues();
  updateStats();
  closeAddVenueModal();
}

function downloadTemplate() {
    const csvContent = 
`×©× ×”××§×•×,×¡×•×’ ××§×•×,×¢×™×¨,××–×•×¨,××™×© ×§×©×¨,×˜×œ×¤×•×Ÿ,××™××™×™×œ,×¤×¨×˜×™× ×¢×œ ×”××§×•×
×”×¤××‘ ×©×œ × ×ª× ××œ,×‘×¨,×¤×¨×•×“,×¦×¤×•×Ÿ,× ×ª× ××œ,052-4541565,netanelkuperman@yahoo.com,×¤××‘ ××¢×•×œ×” ×”×××•×§× ×‘××§×•× ×¤×¡×˜×•×¨×œ×™ ×‘×¦×¤×•×Ÿ.`;

    // ×”×•×¡×¤×ª BOM (Byte Order Mark)
    const BOM = "\uFEFF";
    const blob = new Blob([BOM + csvContent], { type: "text/csv;charset=utf-8;" });
    const link = document.createElement("a");
    link.href = URL.createObjectURL(blob);
    link.download = "template.csv";
    link.style.display = "none";
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
}

        // ×¡×’×™×¨×ª ××•×“×œ×™× ×‘×œ×—×™×¦×” ××—×•×¥ ×œ×ª×•×›×Ÿ
        window.onclick = function(event) {
            const aiModal = document.getElementById('aiModal');
            const messageModal = document.getElementById('messageModal');
            
            if (event.target === aiModal) {
                closeAiAssistant();
            }
            if (event.target === messageModal) {
                closeMessageModal();
            }
			    const conversationModal = document.getElementById('conversationModal');
            if (event.target === conversationModal) {
                closeConversationModal();
            }
        };
    

function closeVenueModal() {
    document.getElementById('venueModal').style.display = 'none';
}

function saveVenueConversation() {
    let text = '';
    let textArea = null;
    let historyDiv = null;
    const data = JSON.parse(localStorage.getItem('venueChats') || '{}');

    // × ×–×”×” ×‘××™×–×” ××•×“×œ × ××¦××™×
    const isConversationModal = document.getElementById('conversationModal').style.display === 'block';
    const isVenueModal = document.getElementById('venueModal').style.display === 'block';

    if (isConversationModal) {
        textArea = document.getElementById('conversationText');
        historyDiv = document.getElementById('conversationHistory');
    } else if (isVenueModal) {
        textArea = document.getElementById('venueModalText');
        historyDiv = document.getElementById('venueModalHistory');
    }

    if (!textArea) return;
    text = textArea.value.trim();

    if (!text) {
        alert('×œ× × ×™×ª×Ÿ ×œ×©××•×¨ ×©×™×—×” ×¨×™×§×”');
        return;
    }

    if (!data[currentConversationVenueId]) {
        data[currentConversationVenueId] = [];
    }

    data[currentConversationVenueId].push({
        text,
        time: new Date().toLocaleString('he-IL')
    });

    localStorage.setItem('venueChats', JSON.stringify(data));

    const history = data[currentConversationVenueId];
    historyDiv.innerHTML = history.map(chat => `
        <div style="margin-bottom: 8px;">
            <div style="font-size: 0.85em; color: gray;">ğŸ“… ${chat.time}</div>
            <div>${chat.text}</div>
        </div>
    `).join('');

    textArea.value = '';
    renderVenues();


}

</script>
</body>
</html>
